---
layout: post
title: php正则表达式
tags:
- PHP
categories: PHP
description: 正则表达式，又称正规表示式、正规表示法，是计算机科学的一个概念。正则表达式使用单个字符串来描述、匹配一系列匹配某个句法规则的字符串。许多程序设计语言都支持利用正则表达式进行字符串操作。

---

##PHP里常用的正则表达式函数##
- **preg_match($pattren , $subject)**

`preg_match()`返回pattern的匹配次数。它的值将是0次（不匹配）或1次，因为`preg_match()`在第一次匹配后 将会停止搜索。`preg_match_all()`不同于此，它会一直搜索subject 直到到达结尾。 如果发生错误`preg_match()`返回 FALSE。常用于表单认证。

- **preg_match\_all($pattren , $subject , array &$matches)**

`preg_match_all()` — 执行一个全局正则表达式匹配。返回完整匹配次数（可能是0），或者如果发生错误返回FALSE。

- **preg_replace($pattern , $replacement , $subject)**

`preg_replace()` — 执行一个正则表达式的搜索和替换。 如果subject是一个数组，`preg_replace()`返回一个数组， 其他情况下返回一个字符串。如果匹配被查找到，替换后的subject被返回，其他情况下 返回没有改变的 subject。如果发生错误，返回 NULL 。常用于非法词语过滤。

- **preg_filter($pattern , $replacement , $subject)**

`preg_filter()` — 执行一个正则表达式搜索和替换。 如果subject是一个数组，返回一个数组， 其他情况返回一个字符串。如果没有找到匹配或者发生了错误，当subject是数组时返回一个空数组，其他情况返回NULL。

`preg_filter()`和`preg_replace()`的示例：

```php
<?php
$subject = array('1', 'a', '2', 'b', '3', 'A', 'B', '4'); 
$pattern = array('/\d/', '/[a-z]/', '/[1a]/'); 
$replace = array('A:$0', 'B:$0', 'C:$0'); 

echo "preg_filter returns\n";
print_r(preg_filter($pattern, $replace, $subject)); 

echo "preg_replace returns\n";
print_r(preg_replace($pattern, $replace, $subject)); 
?>
```

输出结果：

```
preg_filter returns
Array
(
    [0] => A:C:1
    [1] => B:C:a
    [2] => A:2
    [3] => B:b
    [4] => A:3
    [7] => A:4
)
preg_replace returns
Array
(
    [0] => A:C:1
    [1] => B:C:a
    [2] => A:2
    [3] => B:b
    [4] => A:3
    [5] => A
    [6] => B
    [7] => A:4
)
```

- **preg_grep($pattern , array $input)**

`preg_grep()` — 返回匹配模式的数组条目,返回使用input中key做索引的数组。

- **preg_split($pattren , $subject)**

`preg_split()` — 通过一个正则表达式分隔字符串。返回一个使用 pattern 边界分隔subject后得到的子串组成的数组。

- **preg_quote($str)**

preg_quote — 转义正则表达式字符。

##基本语法##

- **界定符**

表示一个正则表达式的开始和结束。正则表达式其实就是一个字符串，用界定符来界定。界定符可以使用//、##、{}。一般情况不建议使用大括号（因为大括号是运算符！）

例如：`$pattern = /[a-z]/;`

- **可见原子**

可见原子时Unicode编码表中用键盘输出后肉眼可见的字符。包括：1、标点；2、英文字母数字；3、汉字，日文，阿拉伯文等其他语言文字；4、`∑`，`∈`，`≌`等数理化公式符号；5、其他可见字符等。

- **不可见原子**

不可见原子就是Unicode编码中用键盘输出后肉眼不可见的字符。
例如：1、换行符：`\n`；2、回车：`\r`；3、制表符：`\t`；4、空格；5、其他不可见的符号等。

- **元字符**

（1）、原子的筛选方式：

`|` 匹配有两个或者多个分支选择；

`[]` 匹配方括号中的任意一个原子；

`[^]` 匹配除了方括号中的原子以外的任意字符；

（2）、原子的集合

`.`  匹配除了换行符之外的任意字符；

`/d`  匹配任意一个十进制数字；

`/D`  匹配一个非十进制数字；

`/s`  匹配一个不可见原子；

`/S`  匹配一个可见原子；

`/w`  匹配任意一个数字、字母或下划线；

`/W`  匹配任意一个非数字、字母或下划线；

- **量词**

`{n}`  表示其前面的原子刚好出现n次；

`{n,}`  表示其前面的原子最少出现n次；

`{n,m}`  表示其前面的原子最少出现n次，最多出现m次；

`*`  匹配0次、1次或者多次其之前的原子；即`{0,}`

`+`  匹配1次或者多次其之前的原子，即`{1,}`

`?`  匹配0次或1次其之前的原子，即`{0,1}`

- **边界控制**

`^`  匹配字符串开始的位置；

`$`  匹配字符串结尾的位置；

`()`  匹配其中的整体为一个原子；

##一些常见的正则表达式##

- **贪婪匹配和懒惰匹配**

（1）、贪婪匹配：匹配结果存在歧义时取其长。默认采用贪婪模式。

（2）、懒惰匹配：匹配结果存在歧义时取其短。要使用懒惰模式，只需在界定符后面加上`U`。

- **常见的修正模式**

`U`  懒惰匹配

`i`  忽略英文字母的大小写

`x`  忽略空白

`s`  让元字符 `.` 匹配包含换行符在内的所有字符

- **几个常见的例子**

保留两位数浮点数匹配：`/\d+\.\d{2}$/`

手机号匹配：`1（3|5|7|8|4）\d{9}`

email地址匹配：`^\w+(\.\w+)*@\w+(\.\w+)+$`